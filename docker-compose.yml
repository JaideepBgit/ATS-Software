services:
  backend:
    build:
      context: ./Resume-Matcher/apps/backend
      dockerfile: Dockerfile
    ports:
      - "8888:8888"
    environment:
      - LLM_URL=http://host.docker.internal:1234/v1
      - MODEL_NAME=gemma-3n-e4b
      - API_KEY=lm-studio
      - PORT=8888
      - CORS_ORIGIN=http://localhost:3333
      - DATABASE_URL=sqlite:///./resume_matcher.db
      - DEBUG=true
      - LOG_LEVEL=info
    volumes:
      - backend_data:/app/data
    extra_hosts:
      - "host.docker.internal:host-gateway"

  frontend:
    build:
      context: ./Resume-Matcher/apps/frontend
      dockerfile: Dockerfile
    ports:
      - "3333:3333"
    environment:
      - NEXT_PUBLIC_API_URL=http://localhost:8888
      - PORT=3333
    depends_on:
      - backend
    volumes:
      - ./Resume-Matcher/apps/frontend:/app
      - /app/node_modules
    networks:
      - resume-matcher-network

volumes:
  backend_data:

networks:
  resume-matcher-network:
    driver: bridge
